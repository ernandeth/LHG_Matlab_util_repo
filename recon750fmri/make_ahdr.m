function hdr = make_ahdr(args,scaninfo)
% Creates Analyze header structure from slices structure array

% $Id: make_ahdr.m 1678 2015-02-26 16:53:58Z klitinas $
% $HeadURL: svn+ssh://klitinas@anger.engin.umich.edu/svn/matlab/img/trunk/make_ahdr.m $

pad1(1:28) = char(0);
pad2(1:2) = char(0);
pad4(1:20) = char(1);
pad5(1:6) = char(0);
pad6(1:48) = char(0);
descrip(1:80) = ' ';
pixsz = scaninfo.opfov*10/args.nim/args.zoomer;

% If scaninfo from older rec_setup1 not including slgap, make it 0
if ~isfield(scaninfo,'slgap')
    scaninfo.slgap = 0;
end

hdr = struct(...
      'sizeof_hdr', 348,...
      'pad1', pad1,...
      'extents', 1,...
      'pad2', pad2,...
      'regular','r', ...
      'pad3', ' ',...
      'dims', 3,...
      'xdim', args.nim,...
      'ydim', args.nim,...
      'zdim', scaninfo.nslices,...
      'tdim', 1,...
      'pad4', pad4,...
      'datatype', 4,...   %(short int)
      'bits', 16,...
      'pad5', pad5,...
      'xsize', pixsz,...
      'ysize', pixsz,...
      'zsize', scaninfo.slthick+scaninfo.slgap,...
      'pad6' , char(zeros(48,1)) ,...
      'glmax', 0,...  % we might need this...
      'glmin', 0,...  % we might need this...
      'descrip', descrip,...
      'aux_file'        , char(zeros(24,1)),...
      'orient'          , 0, ...
      'origin'          , zeros(5,1),...
      'generated'       , char(zeros(10,1)),...
      'scannum'         , char(zeros(10,1)),...
      'patient_id'      , char(zeros(10,1)),...
      'exp_date'        , char(zeros(10,1)),...
      'exp_time'        , char(zeros(10,1)),...
      'hist_un0'        , char(zeros(3,1)),...
      'views'           , 0, ...
      'vols_added'      , 0, ...
      'start_field'     , 0, ...
      'field_skip'      , 0, ...
      'omax'            , 0, ...
      'omin'            , 0, ...
      'smax'            , 0,...
      'smin'            , 0 ...
      );

return
